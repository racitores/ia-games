"use strict";(self.webpackChunkia_games=self.webpackChunkia_games||[]).push([[756],{756:(e,t,r)=>{r.r(t),r.d(t,{default:()=>i});var n=r(43),c=r(601),o=r(579);const i=()=>{const e=(0,n.useRef)(null),t=(0,n.useRef)({board:[],piece:null,piecePosition:{x:0,y:0},score:0,gameOver:!1,dropCounter:0,dropInterval:1e3,lastTime:0}),r=20,i=[null,"#FF0D72","#0DC2FF","#0DFF72","#F538FF","#FF8E0D","#FFE138","#3877FF"],s=[[[0,1,0,0],[0,1,0,0],[0,1,0,0],[0,1,0,0]],[[0,2,0],[0,2,0],[2,2,0]],[[0,3,0],[0,3,0],[0,3,3]],[[4,4],[4,4]],[[0,5,5],[5,5,0],[0,0,0]],[[0,0,0],[6,6,6],[0,6,0]],[[7,7,0],[0,7,7],[0,0,0]]],l=()=>{const{piece:n,piecePosition:c,board:o}=t.current,i=e.current.width/r,s=e.current.height/r;for(let e=0;e<n.length;e++)for(let t=0;t<n[e].length;t++)if(0!==n[e][t]){const r=c.x+t,n=c.y+e;if(r<0||r>=i||n>=s||n>=0&&0!==o[n][r])return!0}return!1},a=e=>{const r=t.current;r.piecePosition.x+=e,l()&&(r.piecePosition.x-=e)},d=()=>{const e=t.current,r=e.piece,n=e.piece.length,c=e.piece[0].length,o=Array.from({length:c},(()=>Array(n).fill(0)));for(let t=0;t<n;t++)for(let r=0;r<c;r++)o[r][n-1-t]=e.piece[t][r];e.piece=o,l()&&(e.piece=r)},u=()=>{const e=t.current;e.piecePosition.y++,l()&&(e.piecePosition.y--,h(),m(),p())},h=()=>{const{piece:e,piecePosition:r,board:n}=t.current;e.forEach(((e,t)=>{e.forEach(((e,c)=>{if(0!==e){const o=r.x+c,i=r.y+t;i>=0&&(n[i][o]=e)}}))}))},m=()=>{const n=t.current,c=e.current.height/r,o=e.current.width/r;let i=0;e:for(let e=c-1;e>=0;e--){for(let r=0;r<o;r++)if(0===n.board[e][r])continue e;const t=n.board.splice(e,1)[0].fill(0);n.board.unshift(t),e++,i++}i>0&&(n.score+=100*i,n.dropInterval=Math.max(100,n.dropInterval-20*i),f())},f=()=>{const e=document.getElementById("score-display");e&&(e.textContent=`Puntuaci\xf3n: ${t.current.score}`)},p=()=>{const n=t.current,c=e.current.width/r;if(n.piece=(()=>{const e=Math.floor(Math.random()*s.length);return s[e]})(),n.piecePosition.x=Math.floor(c/2)-Math.floor(n.piece[0].length/2),n.piecePosition.y=0,l()){n.gameOver=!0;const e=document.getElementById("game-over"),t=document.getElementById("final-score");e&&t&&(t.textContent=n.score,e.style.display="block")}},g=function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;const c=t.current;if(!c.gameOver&&e.current){const o=n-c.lastTime;c.lastTime=n,c.dropCounter+=o,c.dropCounter>c.dropInterval&&(u(),c.dropCounter=0);const s=e.current.getContext("2d");s.fillStyle="#000",s.fillRect(0,0,e.current.width,e.current.height),(e=>{const{board:n}=t.current;n.forEach(((t,n)=>{t.forEach(((t,c)=>{0!==t&&(e.fillStyle=i[t],e.fillRect(c*r,n*r,r,r),e.strokeStyle="#000",e.strokeRect(c*r,n*r,r,r))}))}))})(s),(e=>{const{piece:n,piecePosition:c}=t.current;n&&n.forEach(((t,n)=>{t.forEach(((t,o)=>{0!==t&&(e.fillStyle=i[t],e.fillRect((c.x+o)*r,(c.y+n)*r,r,r),e.strokeStyle="#000",e.strokeRect((c.x+o)*r,(c.y+n)*r,r,r))}))}))})(s)}e.current&&(c.animationFrameId=requestAnimationFrame(g))};return(0,n.useEffect)((()=>{const n=e.current,c=n.height/r,o=n.width/r;t.current.board=Array.from({length:c},(()=>Array(o).fill(0))),p(),g();const i=e=>{if(!t.current.gameOver)switch(e.key){case"ArrowLeft":a(-1);break;case"ArrowRight":a(1);break;case"ArrowDown":u();break;case"ArrowUp":d()}};return window.addEventListener("keydown",i),()=>{window.removeEventListener("keydown",i),t.current.animationFrameId&&cancelAnimationFrame(t.current.animationFrameId)}}),[]),(0,o.jsx)("div",{className:"w-full max-w-3xl mx-auto p-4",children:(0,o.jsxs)(c.Zp,{className:"mb-4",children:[(0,o.jsx)(c.aR,{className:"bg-blue-500 text-white",children:(0,o.jsx)(c.ZB,{className:"text-center text-2xl",children:"Tetris"})}),(0,o.jsxs)(c.Wu,{children:[(0,o.jsx)("div",{id:"score-display",className:"text-center text-xl font-bold mb-4",children:"Puntuaci\xf3n: 0"}),(0,o.jsxs)("div",{className:"relative mx-auto border-2 border-gray-800 bg-gray-100",style:{width:"240px",height:"400px"},children:[(0,o.jsx)("canvas",{ref:e,width:240,height:400,className:"touch-none"}),(0,o.jsx)("div",{id:"game-over",className:"absolute inset-0 flex items-center justify-center bg-black bg-opacity-80 text-white",style:{display:"none"},children:(0,o.jsxs)("div",{className:"text-center p-4",children:[(0,o.jsx)("h2",{className:"text-2xl font-bold mb-2",children:"\xa1Juego Terminado!"}),(0,o.jsxs)("p",{className:"mb-4",children:["Tu puntuaci\xf3n final: ",(0,o.jsx)("span",{id:"final-score",children:"0"})]}),(0,o.jsx)("button",{onClick:()=>{const n=t.current,c=e.current.height/r,o=e.current.width/r;n.board=Array.from({length:c},(()=>Array(o).fill(0))),n.score=0,f(),n.dropInterval=1e3,n.gameOver=!1;const i=document.getElementById("game-over");i&&(i.style.display="none"),p()},className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Jugar de nuevo"})]})})]}),(0,o.jsxs)("div",{className:"flex flex-col items-center mt-4",children:[(0,o.jsxs)("div",{className:"grid grid-cols-3 gap-2 mb-2",children:[(0,o.jsx)("button",{onClick:()=>a(-1),className:"p-4 bg-gray-200 rounded",children:"\u2190"}),(0,o.jsx)("button",{onClick:()=>u(),className:"p-4 bg-gray-200 rounded",children:"\u2193"}),(0,o.jsx)("button",{onClick:()=>a(1),className:"p-4 bg-gray-200 rounded",children:"\u2192"})]}),(0,o.jsx)("button",{onClick:()=>d(),className:"w-full p-4 bg-gray-200 rounded",children:"Rotar \u2191"})]})]})]})})}}}]);
//# sourceMappingURL=756.00181c5f.chunk.js.map